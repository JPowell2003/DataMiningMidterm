---
title: "Regork Coupon Campaign Analysis"
Author:
  - Jay Powell
  - Dawson Siebert
  - Nikki Carfora
date: "2024-10-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction
Regork is always seeking new ways to boost revenue, and one powerful tool at its disposal is using coupons to drive sales. However, the effectiveness of coupons varies widely across different customer segments, meaning that marketing resources may be inefficiently allocated without a clear understanding of which demographics respond best. By analyzing Regork’s internal data, including customer transactions, demographics, and coupon redemptions, we can gain key insights into which household segments find coupons most valuable. This analysis will allow the CEO to make better-informed decisions about where to focus marketing efforts, ultimately increasing sales, improving customer satisfaction, and maximizing the return on marketing investments. Based on these findings, we recommend refining coupon strategies for key demographics and exploring alternative strategies for less responsive groups.

# Packages and Libraries Used
The libraries and packages we used include:

* completejourney: Accessed Regork’s internal database, including tables like transactions, demographics, and coupon redemptions.     
* tidyverse: Handled data manipulation tasks such as filtering, joining, and summarizing.      
* dplyr: Used for data wrangling to clean and prepare the data for analysis.      
* ggplot2: Created visualizations to display findings effectively.      
* lubridate: Processed date-related data to analyze campaign timing, like extracting months from timestamps.     
* viridis: Applied visually accessible color schemes to the heatmaps for clearer interpretation.      

```{r imports}
library(completejourney)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(lubridate)
library(viridis)
```

# Data Import, Cleaning, and Merging
We imported and merged multiple datasets, including transactions, demographics, and coupon redemptions. These datasets were linked using key identifiers like household_id and campaign_id. We cleaned the data by checking for missing values in critical fields such as transaction timestamps, household information, and campaign data. To ensure consistency, we created new variables like campaign_start_month, campaign_end_month, and transaction_month, which allowed us to track customer interactions with campaigns over time. Merging these datasets enabled us to assess how customer segments respond to coupon campaigns and which demographic groups demonstrate the highest engagement.
```{r manipulation}
transactions <- get_transactions()
promotions <- get_promotions()
products <- products
demographics <- demographics
coupons <- coupons
coupon_redemptions <- coupon_redemptions
campaign_descriptions <- campaign_descriptions
campaigns <- campaigns

household_campaign <- inner_join(demographics, campaigns, by = "household_id")


household_campaign <- inner_join(campaign_descriptions, household_campaign, "campaign_id")
household_campaign <- inner_join(transactions, household_campaign, "household_id", relationship = "many-to-many")


household_campaign <- household_campaign %>%
  mutate(campaign_start_month = month(start_date, label = FALSE)) %>%
  mutate(campaign_end_month = month(end_date, label = FALSE)) %>%
  mutate(transaction_month = month(transaction_timestamp, label = FALSE))
```

# Transactions Completed by Household Income and Campaign type
To better track campaign engagement, we created new variables such as campaign_start_month, campaign_end_month, and transaction_month. These allowed us to analyze the timing of transactions and campaign performance over specific periods. Additionally, we visualized how different income groups respond to various campaign types (Type A, B, and C) by calculating total transactions completed by household income.

```{r bar chart}
campaigntype <- household_campaign %>%
  ggplot(aes(x = income, fill = campaign_type)) +
  geom_bar() +
  scale_y_continuous() +
  labs(
    x = "Household Income",
    y = "Transactions Completed",
    fill = "Campaign Type",
    title = "Transactions Completed by Household Income and Campaign Type",
    subtitle = "Determining which campaigns are most effective based on household income."
  ) +
  theme_minimal() +  # Optional: Use a minimal theme for a cleaner look
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  

campaigntype
```
This chart reveals that middle-income households, particularly those earning between 35K and 45K, generate the highest number of transactions. Type A campaigns, which offer personalized coupon recommendations, are especially effective for this income group. While Type B and C campaigns also drive engagement, Type A consistently leads across most income segments, emphasizing the importance of personalized promotions.

# Coupon Redemption Rate by Income and Household Size
We introduced the coupon_redemption_rate variable, which was calculated by dividing the number of coupon redemptions by total transactions for each income and household size combination. This metric helped uncover which groups engage most with coupon-based promotions.

```{r heat map}
heatmapdata <- merge(demographics, coupon_redemptions, by = "household_id") %>%
  merge(transactions, by = "household_id")

heatmapdata_2 <- heatmapdata %>%
  group_by(income, household_size) %>%
  summarize(
    coupon_redemptions = n(),
    total_transactions = n_distinct(basket_id),
    .groups = 'drop'
  ) %>%
  mutate(coupon_redemption_rate = coupon_redemptions / total_transactions * 100)

heatmap <- ggplot(heatmapdata_2, aes(x = income, y = household_size, fill = coupon_redemption_rate)) +
  geom_tile() +
  scale_fill_viridis(option = "plasma", name = "Coupon Redemption Rate (%)") +
  labs(x = "Income", 
       y = "Household Size", 
       title = "Coupon Redemption Rate by Income and Household Size")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

heatmap
```
This heatmap highlights that households with 3 members and an income between 125K and 175K exhibit the highest coupon redemption rates. Larger households (5+ members) with lower incomes also have strong coupon engagement, particularly benefiting from personalized campaigns. However, wealthier households (earning over 200K) show less engagement with coupons, indicating that they may respond better to different marketing strategies beyond discounts.

#Third Graph goes here!
```{r line graph}
```

# Key Findings and Recommendations
The analysis shows that middle-income households (particularly those earning 35K-45K) respond most to Type A campaigns, which offer personalized coupons, leading to the highest number of transactions. Households with 3 members earning between $125K and $175K display the highest coupon redemption rates, indicating strong engagement with coupon-based promotions. Larger households (5+ members) with lower incomes also benefit significantly from these campaigns. However, higher-income households (over $200K) show much lower coupon redemption rates, suggesting they may not find coupon-based promotions as valuable. Based on these insights, Regork should focus on tailoring personalized campaigns for middle-income and larger households, while exploring alternative promotional strategies for wealthier consumers. Additionally, refining the Type A campaign to maximize engagement and utilizing seasonal trends can further optimize campaign performance.

# Conclusion
The business problem we addressed was determining how to optimize coupon campaigns to increase sales across different customer demographics. By analyzing transaction, demographic, and coupon redemption data, we identified key insights: middle-income households respond best to personalized coupons, and households with 3 members and higher incomes have the highest coupon redemption rates. Meanwhile, wealthier households are less responsive to coupon-based promotions. Based on these findings, we recommend focusing marketing efforts on high-response demographics, refining personalized coupon campaigns, and exploring alternative strategies for wealthier customers to improve overall marketing efficiency and drive future growth.

# Limitations and Future Work
One limitation of the analysis is that it focuses primarily on household income and size as key demographic factors, potentially overlooking other important variables such as age, location, or shopping behavior, which could also influence coupon redemption rates. Additionally, the analysis doesn't account for seasonal trends or external economic factors that might impact customer responsiveness to promotions. Future work could involve incorporating these additional demographic variables and examining how coupon usage varies across different seasons or regions. Another area for improvement would be to analyze the effectiveness of specific product categories within the coupon campaigns to refine targeting even further. Finally, testing the impact of alternative promotions, such as loyalty rewards or discounts, on less responsive segments like higher-income households could provide valuable insights for diversifying Regork’s marketing strategies.
