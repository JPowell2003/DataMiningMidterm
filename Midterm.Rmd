---
title: "2024_BANA4080_group08_midterm_project"
Author:
  -name: Jay Powell
  -name: Dawson Siebert
  -name: Nikki Carfora
output: html_document
date: "2024-10-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Introduction
Regork is always seeking new ways to boost revenue, and one powerful tool at its disposal is using coupons to drive sales. However, the effectiveness of coupons varies widely across different customer segments, meaning that marketing resources may be inefficiently allocated without a clear understanding of which demographics respond best. By analyzing Regork’s internal data, including customer transactions, demographics, and coupon redemptions, we can gain key insights into which household segments find coupons most valuable. This analysis will allow the CEO to make better-informed decisions about where to focus marketing efforts, ultimately increasing sales, improving customer satisfaction, and maximizing the return on marketing investments. Based on these findings, we recommend refining coupon strategies for key demographics and exploring alternative strategies for less responsive groups.

##Packages and Libraries Used
The libraries and packages we used include
* completejourney: Accessed Regork’s internal database, including tables like transactions, demographics, and coupon redemptions.
* tidyverse: Handled data manipulation tasks such as filtering, joining, and summarizing.
* dplyr: Used for data wrangling to clean and prepare the data for analysis.
* ggplot2: Created visualizations to display findings effectively.
* lubridate: Processed date-related data to analyze campaign timing, like extracting months from timestamps.
* viridis: Applied visually accessible color schemes to the heatmaps for clearer interpretation.

```{r data}
library(completejourney)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(lubridate)

transactions <- get_transactions()
promotions <- get_promotions()
products <- products
demographics <- demographics
coupons <- coupons
coupon_redemptions <- coupon_redemptions
campaign_descriptions <- campaign_descriptions
campaigns <- campaigns

household_campaign <- inner_join(demographics, campaigns, by = "household_id")


household_campaign <- inner_join(campaign_descriptions, household_campaign, "campaign_id")
household_campaign <- inner_join(transactions, household_campaign, "household_id", relationship = "many-to-many")


household_campaign <- household_campaign %>%
  mutate(campaign_start_month = month(start_date, label = FALSE)) %>%
  mutate(campaign_end_month = month(end_date, label = FALSE)) %>%
  mutate(transaction_month = month(transaction_timestamp, label = FALSE))
```

```{r testplots}
campaigntype <- household_campaign %>%
  ggplot(aes(x = income, fill = campaign_type)) +
  geom_bar() +
  scale_y_continuous() +
  labs(
    x = "Household Income",
    y = "Transactions Completed",
    fill = "Campaign Type",
    title = "Transactions Completed by Household Income and Campaign Type",
    subtitle = "Determining which campaigns are most effective based on household income."
  ) +
  theme_minimal() +  # Optional: Use a minimal theme for a cleaner look
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  

campaigntype

heatmapdata <- merge(demographics, coupon_redemptions, by = "household_id") %>%
  merge(transactions, by = "household_id")

heatmapdata_2 <- heatmapdata %>%
  group_by(income, household_size) %>%
  summarize(
    coupon_redemptions = n(),
    total_transactions = n_distinct(basket_id)
  ) %>%
  mutate(coupon_redemption_rate = coupon_redemptions / total_transactions * 100)

heatmap <- ggplot(heatmapdata_2, aes(x = income, y = household_size, fill = coupon_redemption_rate)) +
  geom_tile() +
  scale_fill_viridis(option = "plasma", name = "Coupon Redemption Rate (%)") +
  labs(x = "Income", 
       y = "Household Size", 
       title = "Coupon Redemption Rate by Income and Household Size")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

heatmap

```
